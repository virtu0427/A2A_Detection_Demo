{% extends "base.html" %}
{% block title %}실시간 관제 · A2A 보안 센터{% endblock %}
{% block page_id %}dashboard{% endblock %}
{% block content %}
  <section class="hero">
    <div class="hero-text">
      <h1>실시간 위협 스트림 관제</h1>
      <p>
        에이전트 간 통신에서 감지된 이상 징후를 초 단위로 파악하고,
        대응 우선순위를 설정할 수 있는 라이브 대시보드입니다.
      </p>
      <div class="hero-tags">
        <span>Streaming SSE</span>
        <span>위험 점수 추적</span>
        <span>자동 경보</span>
      </div>
    </div>
    <div class="hero-highlight">
      <h2>오늘의 관측 지표</h2>
      <ul>
        <li><span id="metric-agent-count">-</span><small>연결된 에이전트</small></li>
        <li><span id="metric-high-threats">-</span><small>고위험 탐지</small></li>
        <li><span id="metric-active-links">-</span><small>감시 중 연결</small></li>
        <li><span id="metric-last-update">-</span><small>마지막 갱신</small></li>
      </ul>
    </div>
  </section>

  <section class="panel stack">
    <header class="panel-header">
      <div>
        <h2>실시간 위협 이벤트 피드</h2>
        <p>새로운 위협이 감지되면 자동으로 리스트가 갱신되고 알림이 표시됩니다.</p>
      </div>
      <div class="panel-actions">
        <label class="toggle">
          <input type="checkbox" id="toggle-critical" />
          <span>고위험만 보기</span>
        </label>
        <button type="button" id="btn-refresh-overview">지표 새로고침</button>
      </div>
    </header>
    <div id="live-feed" class="live-feed"></div>
  </section>

  <div class="grid-2">
    <section class="panel">
      <h3>최근 20개 위협 요약</h3>
      <p class="subtext">저장된 분석 로그에서 최신 패킷을 타임라인으로 확인합니다.</p>
      <ol id="timeline-list" class="timeline"></ol>
    </section>
    <section class="panel">
      <h3>관제 노트</h3>
      <div class="note-card">
        <h4>추천 대응</h4>
        <p>동일 ID Task 재시도 패턴이 3회 이상 발생하면 자동 차단 규칙을 검토하세요.</p>
      </div>
      <div class="note-card">
        <h4>모니터링 체크리스트</h4>
        <ul>
          <li>격리된 에이전트의 재연결 시도 추적</li>
          <li>AgentCard 스키마 변경 알림 구독</li>
          <li>Artifact 해시 이상 시 수동 검증 수행</li>
        </ul>
      </div>
    </section>
  </div>
{% endblock %}

{% block extra_body %}
  {{ super() }}
  <div class="toast-container" aria-live="polite"></div>
{% endblock %}
